% --------------------------------------------------------------------------
% the LIBERTINEHOLOGOPATCH package
% 
%   patch kerning of hologo's logos for usage with the `libertine' package
% 
% --------------------------------------------------------------------------
% Clemens Niederberger
% Web:    https://bitbucket.org/cgnieder/libertinehologopatch/
% E-Mail: contact@mychemistry.eu
% --------------------------------------------------------------------------
% Copyright 2013 Clemens Niederberger
% 
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
% 
% This work has the LPPL maintenance status `maintained'.
% 
% The Current Maintainer of this work is Clemens Niederberger.
% --------------------------------------------------------------------------
% The libertinehologopatch package consists of the files
%  - libertinehologopatch.sty
%  - README
% --------------------------------------------------------------------------
% If you have any ideas, questions, suggestions or bugs to report, please
% feel free to contact me.
% --------------------------------------------------------------------------
\def\lbthlpt@date{2013/01/29}
\def\lbthlpt@version{v0.2}
\def\lbthlpt@description{%
  patch kerning of logos provided by `hologo' for use with `libertine' (CN)}

\ProvidesPackage{libertinehologopatch}%
  [\lbthlpt@date\space\lbthlpt@version\space\lbthlpt@description]
\RequirePackage{etoolbox}
\RequirePackage{hologo}[2012/04/26]
\RequirePackage{libertine}[2012/12/27]

\def\lbthlpt@family@biolinumOsF{LinuxBiolinumT-OsF}
\def\lbthlpt@family@biolinumLF{LinuxBiolinumT-LF}

\def\lbthlpt@failure#1#2{%
  \PackageWarning{libertinehologopatch}
    {Patching of logo `#1' (\string#2) failed.}
}
\def\lbthlpt@success#1#2{%
  \PackageInfo{libertinehologopatch}
    {Patching of logo `#1' (\string#2) successful.}
}

% --------------------------------------------------------------------------
% wrap \ifx:
\def\lbthlpt@ifx#1#2{%
  \ifx#1#2%
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
}

% test for biolinum:
\def\lbthlpt@ifbiolinum{%
  \ifboolexpr{
    test {\lbthlpt@ifx\f@family\lbthlpt@family@biolinumOsF} or
    test {\lbthlpt@ifx\f@family\lbthlpt@family@biolinumLF}
  }
}

% test for italics:
\def\lbthlpt@ifit{%
  \lbthlpt@ifx\f@shape\lbthlpt@itshape
}
\def\lbthlpt@itshape{it}

% test for small caps:
\def\lbthlpt@ifsc{%
  \lbthlpt@ifx\f@shape\lbthlpt@scshape
}
\def\lbthlpt@scshape{sc}

% ----------------------------------------------------------------------------
% save unpatched versions:
\newcommand*\lbthlpt@save[1]{%
  \csletcs{lbthlpt@unpatched@#1}{HoLogo@#1}}
\newcommand*\lbthlpt@get@unpatched[1]{%
  \csuse{lbthlpt@unpatched@#1}}

% restore unpatched versions:
\newcommand*\lbthlpt@restore[1]{%
  \csletcs{HoLogo@#1}{lbthlpt@unpatched@#1}}

% ----------------------------------------------------------------------------
% the patching:
%%% La: between L and A
\lbthlpt@save{La}
\patchcmd\HoLogo@La
  {\kern-.36em}
  {%
    \lbthlpt@ifbiolinum
      {\lbthlpt@ifit{\kern-.23em}{\kern-.28em}}
      {\lbthlpt@ifit{\kern-.24em}{\kern-.29em}}%
  }
  {\lbthlpt@success{La}{\HoLogo@La}}
  {\lbthlpt@failure{La}{\HoLogo@La}}

%%% TeX
% between T and eX
\lbthlpt@save{TeX}
\patchcmd\HoLogo@TeX
  {\kern-.1667em}
  {%
    \lbthlpt@ifbiolinum
      {\lbthlpt@ifit{\kern-.2000em}{\kern-.1667em}}
      {\lbthlpt@ifit{\kern-.1667em}{\kern-.1667em}}%
  }
  {\lbthlpt@success{TeX}{\HoLogo@TeX}}
  {\lbthlpt@failure{TeX}{\HoLogo@TeX}}
% between Te and X
\patchcmd\HoLogo@TeX
  {\kern-.125em}
  {%
    \lbthlpt@ifbiolinum
      {\lbthlpt@ifit{\kern-.065em}{\kern-.105em}}
      {\lbthlpt@ifit{\kern-.105em}{\kern-.125em}}%
  }
  {\lbthlpt@success{TeX}{\HoLogo@TeX}}
  {\lbthlpt@failure{TeX}{\HoLogo@TeX}}

%%% LaTeX: between La and TeX
\lbthlpt@save{LaTeX}
\patchcmd\HoLogo@LaTeX
  {\kern-.15em}
  {%
    \lbthlpt@ifbiolinum
      {\lbthlpt@ifit{\kern-.13em}{\kern-0.085em}}
      {\lbthlpt@ifit{\kern-.13em}{\kern-.11em}}%
  }
  {\lbthlpt@success{LaTeX}{\HoLogo@LaTeX}}
  {\lbthlpt@failure{LaTeX}{\HoLogo@LaTeX}}

%%% Xe: between X and e
\lbthlpt@save{Xe}
\patchcmd\HoLogo@Xe
  {\kern-.1em}
  {%
    \lbthlpt@ifbiolinum
      {\lbthlpt@ifit{\kern-.05em}{\kern-.1em}}
      {\lbthlpt@ifit{\kern-.05em}{\kern-.1em}}%
  }
  {\lbthlpt@success{Xe}{\HoLogo@Xe}}
  {\lbthlpt@failure{Xe}{\HoLogo@Xe}}

%%% XeTeX: between Xe and TeX
\lbthlpt@save{XeTeX}
\patchcmd\HoLogo@XeTeX
  {\kern-.15em}
  {%
    \lbthlpt@ifbiolinum
      {\lbthlpt@ifit{\kern-.24em}{\kern-.15em}}
      {\lbthlpt@ifit{\kern-.235em}{\kern-.15em}}%
  }
  {\lbthlpt@success{XeTeX}{\HoLogo@XeTeX}}
  {\lbthlpt@failure{XeTeX}{\HoLogo@XeTeX}}

%%% XeLaTeX: between Xe an LaTeX
\lbthlpt@save{XeLaTeX}
\patchcmd\HoLogo@XeLaTeX
  {\kern-.13em}
  {%
    \lbthlpt@ifbiolinum
      {\lbthlpt@ifit{\kern-.15em}{\kern-.09em}}
      {\lbthlpt@ifit{\kern-.09em}{\kern-.025em}}%
  }
  {\lbthlpt@success{XeLaTeX}{\HoLogo@XeLaTeX}}
  {\lbthlpt@failure{XeLaTeX}{\HoLogo@XeLaTeX}}

%%% LaTeXTeX
\lbthlpt@save{LaTeXTeX}
% between ( and La
\patchcmd\HoLogo@LaTeXTeX
  {\kern-.15em}
  {\lbthlpt@ifbiolinum{\kern-.09em}{\kern-.06em}}
  {\lbthlpt@success{(La)TeX}{\HoLogo@LaTeXTeX}}
  {\lbthlpt@failure{(La)TeX}{\HoLogo@LaTeXTeX}}
% between La and )
\patchcmd\HoLogo@LaTeXTeX
  {\kern-.2em}
  {%
    \lbthlpt@ifbiolinum
      {\lbthlpt@ifit{\kern-.14em}{\kern-.12em}}
      {\lbthlpt@ifit{\kern-.14em}{\kern-.12em}}%
  }
  {\lbthlpt@success{(La)TeX}{\HoLogo@LaTeXTeX}}
  {\lbthlpt@failure{(La)TeX}{\HoLogo@LaTeXTeX}}
% between ) and TeX
\patchcmd\HoLogo@LaTeXTeX
  {\kern-.15em}
  {\kern-.09em}
  {\lbthlpt@success{(La)TeX}{\HoLogo@LaTeXTeX}}
  {\lbthlpt@failure{(La)TeX}{\HoLogo@LaTeXTeX}}

%%% (La)TeX
\lbthlpt@save{(La)TeX}
\cslet{HoLogo@(La)TeX}\HoLogo@LaTeXTeX

% --------------------------------------------------------------------------
% restore originals
\def\lbthlpt@restore@originals{%
  \lbthlpt@restore{La}%
  \lbthlpt@restore{TeX}%
  \lbthlpt@restore{LaTeX}%
  \lbthlpt@restore{Xe}%
  \lbthlpt@restore{XeTeX}%
  \lbthlpt@restore{XeLaTeX}%
  \lbthlpt@restore{LaTeXTeX}%
  \lbthlpt@restore{(La)TeX}%
}
\newrobustcmd\restorelogos{%
  \lbthlpt@restore@originals}

% --------------------------------------------------------------------------
% shortcuts (with pdf bookmark support via hyperref)
\AtBeginDocument{
  \renewrobustcmd\TeX{\hologo{TeX}}
  \renewrobustcmd\LaTeX{\hologo{LaTeX}}
  \renewrobustcmd\LaTeXe{\hologo{LaTeX2e}}
  \ifdef\LaTeXTeX
    {\renewrobustcmd\LaTeXTeX{\hologo{LaTeXTeX}}}
    {\newrobustcmd\LaTeXTeX{\hologo{LaTeXTeX}}}
  \ifdef\pdfTeX
    {\renewrobustcmd\pdfTeX{\hologo{pdfTeX}}}
    {\newrobustcmd\pdfTeX{\hologo{pdfTeX}}}
  \ifdef\pdfLaTeX
    {\renewrobustcmd\pdfLaTeX{\hologo{pdfLaTeX}}}
    {\newrobustcmd\pdfLaTeX{\hologo{pdfLaTeX}}}
  \ifdef\XeTeX
    {\renewrobustcmd\XeTeX{\hologo{XeTeX}}}
    {\newrobustcmd\XeTeX{\hologo{XeTeX}}}
  \ifdef\XeLaTeX
    {\renewrobustcmd\XeLaTeX{\hologo{XeLaTeX}}}
    {\newrobustcmd\XeLaTeX{\hologo{XeLaTeX}}}
  \ifdef\LuaTeX
    {\renewrobustcmd\LuaTeX{\hologo{LuaTeX}}}
    {\newrobustcmd\LuaTeX{\hologo{LuaTeX}}}
  \ifdef\LuaLaTeX
    {\renewrobustcmd\LuaLaTeX{\hologo{LuaLaTeX}}}
    {\newrobustcmd\LuaLaTeX{\hologo{LuaLaTeX}}}
  \@ifpackageloaded{hyperref}
    {
      \pdfstringdefDisableCommands
        {
          \def\TeX{TeX}
          \def\LaTeX{LaTeX}
          \def\LaTeXe{LaTeX 2e}
          \def\LaTeXTeX{(La)TeX}
          \def\pdfTeX{pdfTeX}
          \def\pdfLaTeX{pdfLaTeX}
          \def\XeTeX{XeTeX}
          \def\XeLaTeX{XeLaTeX}
          \def\LuaTeX{LuaTeX}
          \def\LuaLaTeX{LuaLaTeX}
        }
    }{}
}

\endinput
% TODO:
- LuaTeX : Libertine sc : zu große Lücke zwischen Lua und TeX